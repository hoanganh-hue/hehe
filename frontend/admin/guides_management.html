

Quản lý Hướng dẫn - ZaloPay Admin Portal


<div class="container-fluid">
    <!-- Page header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-0">Quản lý Hướng dẫn</h1>
            <p class="text-muted">Tạo và quản lý các hướng dận chi tiết cho khách hàng và đối tác</p>
        </div>
        <div>
            <button class="btn btn-primary me-2" onclick="createNewGuide()">
                <i class="fas fa-plus me-1"></i>Tạo hướng dẫn mới
            </button>
            <button class="btn btn-info me-2" onclick="importGuides()">
                <i class="fas fa-upload me-1"></i>Nhập từ file
            </button>
            <button class="btn btn-success me-2" onclick="exportGuides()">
                <i class="fas fa-download me-1"></i>Xuất danh sách
            </button>
            <div class="btn-group" role="group">
                <button class="btn btn-outline-primary active" onclick="filterByStatus('')">Tất cả</button>
                <button class="btn btn-outline-success" onclick="filterByStatus('published')">Đã xuất bản</button>
                <button class="btn btn-outline-warning" onclick="filterByStatus('draft')">Bản nháp</button>
                <button class="btn btn-outline-info" onclick="filterByStatus('review')">Chờ duyệt</button>
                <button class="btn btn-outline-secondary" onclick="filterByStatus('archived')">Ẩn</button>
            </div>
        </div>
    </div>

    <!-- Statistics Dashboard -->
    <div class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                Tổng hướng dẫn
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="totalGuides">
                                78
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-book fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-success shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                Đã xuất bản
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="publishedGuides">
                                45
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-check-circle fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                Lượt xem (tháng)
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="monthlyViews">
                                23,456
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-chart-bar fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-warning shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                Đánh giá trung bình
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="averageRating">
                                4.7/5.0
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-star fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions & Popular Guides -->
    <div class="row mb-4">
        <div class="col-lg-8">
            <!-- Popular Guides This Week -->
            <div class="card border-left-success shadow mb-4">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                Hướng dẫn phổ biến nhất tuần
                            </div>
                            <div class="h6 mb-0 font-weight-bold text-gray-800">
                                "Hướng dẫn tích hợp API thanh toán cho website" - 2,345 lượt xem
                            </div>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-success btn-sm" onclick="viewGuideAnalytics()">
                                <i class="fas fa-analytics me-1"></i>Xem chi tiết
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <!-- Guide Categories -->
            <div class="card shadow mb-4">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <h6 class="m-0 font-weight-bold text-primary">Danh mục hướng dẫn</h6>
                    <button class="btn btn-sm btn-primary" onclick="manageGuideCategories()">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
                <div class="card-body">
                    <div class="mb-2">
                        <div class="d-flex justify-content-between">
                            <span>Tích hợp API</span>
                            <span class="badge bg-primary">18</span>
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="d-flex justify-content-between">
                            <span>Đăng ký đối tác</span>
                            <span class="badge bg-primary">12</span>
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="d-flex justify-content-between">
                            <span>Quản lý thanh toán</span>
                            <span class="badge bg-primary">15</span>
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="d-flex justify-content-between">
                            <span>Bảo mật</span>
                            <span class="badge bg-primary">8</span>
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="d-flex justify-content-between">
                            <span>Khắc phục sự cố</span>
                            <span class="badge bg-primary">6</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Advanced Filters -->
    <div class="card mb-4">
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">Tìm kiếm</label>
                    <input type="text" class="form-control" id="searchInput" placeholder="Tiêu đề, nội dung, từ khóa...">
                </div>
                <div class="col-md-2">
                    <label class="form-label">Trạng thái</label>
                    <select class="form-select" id="statusFilter">
                        <option value="">Tất cả</option>
                        <option value="published">Đã xuất bản</option>
                        <option value="draft">Bản nháp</option>
                        <option value="review">Chờ duyệt</option>
                        <option value="archived">Ẩn</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">Danh mục</label>
                    <select class="form-select" id="categoryFilter">
                        <option value="">Tất cả</option>
                        <option value="api">Tích hợp API</option>
                        <option value="registration">Đăng ký đối tác</option>
                        <option value="payment">Quản lý thanh toán</option>
                        <option value="security">Bảo mật</option>
                        <option value="troubleshoot">Khắc phục sự cố</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">Mức độ khó</label>
                    <select class="form-select" id="difficultyFilter">
                        <option value="">Tất cả</option>
                        <option value="beginner">Cơ bản</option>
                        <option value="intermediate">Trung bình</option>
                        <option value="advanced">Nâng cao</option>
                        <option value="expert">Chuyên gia</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label class="form-label">Tác giả</label>
                    <select class="form-select" id="authorFilter">
                        <option value="">Tất cả</option>
                        <option value="admin">Admin</option>
                        <option value="content_team">Content Team</option>
                        <option value="tech_team">Tech Team</option>
                        <option value="support_team">Support Team</option>
                    </select>
                </div>
                <div class="col-md-1 d-flex align-items-end">
                    <button class="btn btn-primary w-100" onclick="applyFilters()">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Guides Management Table -->
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h6 class="m-0 font-weight-bold text-primary">
                Danh sách hướng dẫn
                <span class="badge bg-secondary" id="totalRecords">78 kết quả</span>
            </h6>
            <div>
                <button class="btn btn-sm btn-outline-primary" onclick="bulkPublish()">
                    <i class="fas fa-eye me-1"></i>Xuất bản hàng loạt
                </button>
                <button class="btn btn-sm btn-outline-info" onclick="bulkReview()">
                    <i class="fas fa-search me-1"></i>Gửi duyệt hàng loạt
                </button>
                <button class="btn btn-sm btn-outline-warning" onclick="bulkArchive()">
                    <i class="fas fa-archive me-1"></i>Ẩn hàng loạt
                </button>
            </div>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover" id="guidesTable">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAll"></th>
                            <th>ID</th>
                            <th>Tiêu đề</th>
                            <th>Danh mục</th>
                            <th>Mức độ</th>
                            <th>Trạng thái</th>
                            <th>Lượt xem</th>
                            <th>Đánh giá</th>
                            <th>Tác giả</th>
                            <th>Cập nhật</th>
                            <th>Thao tác</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="checkbox" name="guideSelect" value="GD-001"></td>
                            <td>GD-001</td>
                            <td>
                                <div class="fw-bold">Hướng dẫn tích hợp API thanh toán ZaloPay</div>
                                <small class="text-muted">Hướng dẫn chi tiết cách tích hợp API cho website...</small>
                                <div class="mt-1">
                                    <span class="badge bg-secondary">API</span>
                                    <span class="badge bg-secondary">Tích hợp</span>
                                    <span class="badge bg-secondary">Website</span>
                                </div>
                            </td>
                            <td><span class="badge bg-info">Tích hợp API</span></td>
                            <td>
                                <span class="badge bg-warning">Trung bình</span>
                                <div class="progress mt-1" style="height: 4px;">
                                    <div class="progress-bar bg-warning" style="width: 60%"></div>
                                </div>
                            </td>
                            <td><span class="badge bg-success">Đã xuất bản</span></td>
                            <td>
                                <div class="fw-bold">2,345</div>
                                <small class="text-success">+234 tuần này</small>
                            </td>
                            <td>
                                <div class="fw-bold text-warning">4.8/5.0</div>
                                <small class="text-muted">(89 đánh giá)</small>
                            </td>
                            <td>
                                <div>Tech Team</div>
                                <small class="text-muted">01/10/2025</small>
                            </td>
                            <td>
                                <div>04/10/2025</div>
                                <small class="text-muted">09:30</small>
                            </td>
                            <td>
                                <div class="btn-group" role="group">
                                    <button class="btn btn-sm btn-outline-primary" onclick="viewGuide('GD-001')" title="Xem">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-warning" onclick="editGuide('GD-001')" title="Chỉnh sửa">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-info" onclick="duplicateGuide('GD-001')" title="Sao chép">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-success" onclick="viewGuideStats('GD-001')" title="Thống kê">
                                        <i class="fas fa-chart-line"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" name="guideSelect" value="GD-002"></td>
                            <td>GD-002</td>
                            <td>
                                <div class="fw-bold">Cách đăng ký trở thành đối tác ZaloPay</div>
                                <small class="text-muted">Quy trình đăng ký đối tác từ A đến Z...</small>
                                <div class="mt-1">
                                    <span class="badge bg-secondary">Đăng ký</span>
                                    <span class="badge bg-secondary">Đối tác</span>
                                    <span class="badge bg-secondary">Mới bắt đầu</span>
                                </div>
                            </td>
                            <td><span class="badge bg-primary">Đăng ký đối tác</span></td>
                            <td>
                                <span class="badge bg-success">Cơ bản</span>
                                <div class="progress mt-1" style="height: 4px;">
                                    <div class="progress-bar bg-success" style="width: 30%"></div>
                                </div>
                            </td>
                            <td><span class="badge bg-success">Đã xuất bản</span></td>
                            <td>
                                <div class="fw-bold">1,876</div>
                                <small class="text-success">+98 tuần này</small>
                            </td>
                            <td>
                                <div class="fw-bold text-warning">4.6/5.0</div>
                                <small class="text-muted">(156 đánh giá)</small>
                            </td>
                            <td>
                                <div>Content Team</div>
                                <small class="text-muted">28/09/2025</small>
                            </td>
                            <td>
                                <div>02/10/2025</div>
                                <small class="text-muted">15:45</small>
                            </td>
                            <td>
                                <div class="btn-group" role="group">
                                    <button class="btn btn-sm btn-outline-primary" onclick="viewGuide('GD-002')" title="Xem">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-warning" onclick="editGuide('GD-002')" title="Chỉnh sửa">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-info" onclick="duplicateGuide('GD-002')" title="Sao chép">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-success" onclick="viewGuideStats('GD-002')" title="Thống kê">
                                        <i class="fas fa-chart-line"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" name="guideSelect" value="GD-003"></td>
                            <td>GD-003</td>
                            <td>
                                <div class="fw-bold">Xử lý lỗi kết nối API thường gặp</div>
                                <small class="text-muted">Các lỗi thường gặp và cách khắc phục...</small>
                                <div class="mt-1">
                                    <span class="badge bg-secondary">Lỗi</span>
                                    <span class="badge bg-secondary">API</span>
                                    <span class="badge bg-secondary">Khắc phục</span>
                                </div>
                            </td>
                            <td><span class="badge bg-danger">Khắc phục sự cố</span></td>
                            <td>
                                <span class="badge bg-danger">Nâng cao</span>
                                <div class="progress mt-1" style="height: 4px;">
                                    <div class="progress-bar bg-danger" style="width: 80%"></div>
                                </div>
                            </td>
                            <td><span class="badge bg-warning">Chờ duyệt</span></td>
                            <td>
                                <div class="fw-bold">-</div>
                                <small class="text-muted">Chưa xuất bản</small>
                            </td>
                            <td>
                                <div class="fw-bold text-muted">-</div>
                                <small class="text-muted">Chưa có</small>
                            </td>
                            <td>
                                <div>Support Team</div>
                                <small class="text-muted">04/10/2025</small>
                            </td>
                            <td>
                                <div>04/10/2025</div>
                                <small class="text-muted">08:20</small>
                            </td>
                            <td>
                                <div class="btn-group" role="group">
                                    <button class="btn btn-sm btn-outline-primary" onclick="viewGuide('GD-003')" title="Xem">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-warning" onclick="editGuide('GD-003')" title="Chỉnh sửa">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-success" onclick="approveGuide('GD-003')" title="Duyệt">
                                        <i class="fas fa-check"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-danger" onclick="rejectGuide('GD-003')" title="Từ chối">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <nav aria-label="Guide pagination" class="mt-4">
                <ul class="pagination justify-content-center">
                    <li class="page-item disabled">
                        <span class="page-link">Trước</span>
                    </li>
                    <li class="page-item active">
                        <span class="page-link">1</span>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="#">2</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="#">3</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="#">Tiếp</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- Create/Edit Guide Modal -->
<div class="modal fade" id="guideModal" tabindex="-1">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="guideModalTitle">Tạo hướng dẫn mới</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-9">
                        <form id="guideForm">
                            <div class="mb-3">
                                <label class="form-label">Tiêu đề hướng dẫn:</label>
                                <input type="text" class="form-control" id="guideTitle" required placeholder="Nhập tiêu đề hướng dẫn...">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Mô tả ngắn:</label>
                                <textarea class="form-control" id="guideDescription" rows="2" placeholder="Mô tả ngắn về nội dung hướng dẫn..."></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Nội dung hướng dẫn:</label>
                                <div class="border" style="min-height: 400px;">
                                    <div class="toolbar p-2 border-bottom">
                                        <button type="button" class="btn btn-sm btn-outline-secondary me-1" onclick="formatText('bold')">
                                            <i class="fas fa-bold"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary me-1" onclick="formatText('italic')">
                                            <i class="fas fa-italic"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary me-1" onclick="formatText('underline')">
                                            <i class="fas fa-underline"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary me-1" onclick="insertList('ul')">
                                            <i class="fas fa-list-ul"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary me-1" onclick="insertList('ol')">
                                            <i class="fas fa-list-ol"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary me-1" onclick="insertLink()">
                                            <i class="fas fa-link"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary me-1" onclick="insertImage()">
                                            <i class="fas fa-image"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary me-1" onclick="insertCode()">
                                            <i class="fas fa-code"></i>
                                        </button>
                                    </div>
                                    <div id="guideContentEditor" contenteditable="true" class="p-3" style="min-height: 350px; outline: none;">
                                        <h2>Bước 1: Chuẩn bị</h2>
                                        <p>Mô tả các bước chuẩn bị cần thiết...</p>
                                        
                                        <h2>Bước 2: Thực hiện</h2>
                                        <p>Hướng dẫn chi tiết cách thực hiện...</p>
                                        
                                        <h2>Bước 3: Kiểm tra</h2>
                                        <p>Cách kiểm tra kết quả...</p>
                                    </div>
                                </div>
                                <input type="hidden" id="guideContent">
                            </div>
                        </form>
                    </div>
                    <div class="col-md-3">
                        <!-- Guide Settings -->
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0">Cài đặt hướng dẫn</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Danh mục:</label>
                                    <select class="form-select" id="guideCategory" required>
                                        <option value="">Chọn danh mục</option>
                                        <option value="api">Tích hợp API</option>
                                        <option value="registration">Đăng ký đối tác</option>
                                        <option value="payment">Quản lý thanh toán</option>
                                        <option value="security">Bảo mật</option>
                                        <option value="troubleshoot">Khắc phục sự cố</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Mức độ khó:</label>
                                    <select class="form-select" id="guideDifficulty">
                                        <option value="beginner">Cơ bản</option>
                                        <option value="intermediate">Trung bình</option>
                                        <option value="advanced">Nâng cao</option>
                                        <option value="expert">Chuyên gia</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Trạng thái:</label>
                                    <select class="form-select" id="guideStatus">
                                        <option value="draft">Bản nháp</option>
                                        <option value="review">Chờ duyệt</option>
                                        <option value="published">Đã xuất bản</option>
                                        <option value="archived">Ẩn</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Từ khóa (SEO):</label>
                                    <input type="text" class="form-control" id="guideTags" placeholder="api, tích hợp, thanh toán...">
                                    <small class="text-muted">Cách nhau bằng dấu phẩy</small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Thời gian đọc (phút):</label>
                                    <input type="number" class="form-control" id="guideReadTime" value="5" min="1">
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="guideFeatured">
                                        <label class="form-check-label" for="guideFeatured">
                                            Hướng dẫn nổi bật
                                        </label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="guideNotifyUsers">
                                        <label class="form-check-label" for="guideNotifyUsers">
                                            Thông báo người dùng
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Guide Analytics (for edit mode) -->
                        <div class="card mt-3" id="guideAnalyticsCard" style="display: none;">
                            <div class="card-header">
                                <h6 class="mb-0">Thống kê</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-2">
                                    <small class="text-muted">Lượt xem:</small>
                                    <div class="fw-bold" id="guideViews">0</div>
                                </div>
                                <div class="mb-2">
                                    <small class="text-muted">Đánh giá:</small>
                                    <div class="fw-bold text-warning" id="guideRating">0/5.0</div>
                                </div>
                                <div class="mb-2">
                                    <small class="text-muted">Lượt chia sẻ:</small>
                                    <div class="fw-bold" id="guideShares">0</div>
                                </div>
                                <div class="mb-2">
                                    <small class="text-muted">Cập nhật cuối:</small>
                                    <div class="fw-bold" id="guideLastUpdated">-</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                <button type="button" class="btn btn-outline-primary" onclick="saveGuideAsDraft()">Lưu bản nháp</button>
                <button type="button" class="btn btn-info" onclick="submitForReview()">Gửi duyệt</button>
                <button type="button" class="btn btn-success" onclick="publishGuideNow()">Xuất bản ngay</button>
            </div>
        </div>
    </div>
</div>

<style>
.border-left-primary {
    border-left: 0.25rem solid #4e73df !important;
}
.border-left-warning {
    border-left: 0.25rem solid #f6c23e !important;
}
.border-left-info {
    border-left: 0.25rem solid #36b9cc !important;
}
.border-left-success {
    border-left: 0.25rem solid #1cc88a !important;
}
.text-gray-800 {
    color: #5a5c69 !important;
}
.text-xs {
    font-size: 0.7rem;
}
.font-weight-bold {
    font-weight: 700 !important;
}
.text-uppercase {
    text-transform: uppercase !important;
}

#guideContentEditor {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    line-height: 1.6;
}

#guideContentEditor h1, #guideContentEditor h2, #guideContentEditor h3 {
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
    font-weight: 600;
}

#guideContentEditor p {
    margin-bottom: 1rem;
}

#guideContentEditor code {
    background-color: #f8f9fa;
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
    font-family: 'Courier New', monospace;
}

#guideContentEditor pre {
    background-color: #f8f9fa;
    padding: 1rem;
    border-radius: 0.25rem;
    overflow-x: auto;
}
</style>

<script>
let currentGuideId = null;
let isEditMode = false;

function filterByStatus(status) {
    document.getElementById('statusFilter').value = status;
    applyFilters();
    
    // Update active button
    document.querySelectorAll('.btn-group .btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
}

function applyFilters() {
    const search = document.getElementById('searchInput').value;
    const status = document.getElementById('statusFilter').value;
    const category = document.getElementById('categoryFilter').value;
    const difficulty = document.getElementById('difficultyFilter').value;
    const author = document.getElementById('authorFilter').value;
    
    console.log('Applying filters:', { search, status, category, difficulty, author });
    showToast('Đang áp dụng bộ lọc...', 'info');
}

function createNewGuide() {
    isEditMode = false;
    currentGuideId = null;
    
    document.getElementById('guideModalTitle').textContent = 'Tạo hướng dẫn mới';
    document.getElementById('guideForm').reset();
    document.getElementById('guideContentEditor').innerHTML = `
        <h2>Bước 1: Chuẩn bị</h2>
        <p>Mô tả các bước chuẩn bị cần thiết...</p>
        
        <h2>Bước 2: Thực hiện</h2>
        <p>Hướng dẫn chi tiết cách thực hiện...</p>
        
        <h2>Bước 3: Kiểm tra</h2>
        <p>Cách kiểm tra kết quả...</p>
    `;
    document.getElementById('guideAnalyticsCard').style.display = 'none';
    
    new bootstrap.Modal(document.getElementById('guideModal')).show();
}

function viewGuide(guideId) {
    console.log('Viewing guide:', guideId);
    editGuide(guideId, true);
}

function editGuide(guideId, viewOnly = false) {
    isEditMode = true;
    currentGuideId = guideId;
    
    // Mock guide data
    const guideData = {
        'GD-001': {
            title: 'Hướng dẫn tích hợp API thanh toán ZaloPay',
            description: 'Hướng dẫn chi tiết cách tích hợp API thanh toán ZaloPay vào website của bạn',
            content: '<h2>Bước 1: Đăng ký tài khoản đối tác</h2><p>Trước tiên, bạn cần đăng ký tài khoản đối tác ZaloPay...</p>',
            category: 'api',
            difficulty: 'intermediate',
            status: 'published',
            tags: 'api, tích hợp, thanh toán, website',
            readTime: 8,
            featured: true,
            views: 2345,
            rating: 4.8,
            shares: 89,
            lastUpdated: '04/10/2025 09:30'
        }
    };
    
    const guide = guideData[guideId] || guideData['GD-001'];
    
    document.getElementById('guideModalTitle').textContent = viewOnly ? 'Xem hướng dẫn' : 'Chỉnh sửa hướng dẫn';
    document.getElementById('guideTitle').value = guide.title;
    document.getElementById('guideDescription').value = guide.description;
    document.getElementById('guideContentEditor').innerHTML = guide.content;
    document.getElementById('guideCategory').value = guide.category;
    document.getElementById('guideDifficulty').value = guide.difficulty;
    document.getElementById('guideStatus').value = guide.status;
    document.getElementById('guideTags').value = guide.tags;
    document.getElementById('guideReadTime').value = guide.readTime;
    document.getElementById('guideFeatured').checked = guide.featured;
    
    // Show analytics for existing guides
    document.getElementById('guideAnalyticsCard').style.display = 'block';
    document.getElementById('guideViews').textContent = guide.views.toLocaleString();
    document.getElementById('guideRating').textContent = guide.rating + '/5.0';
    document.getElementById('guideShares').textContent = guide.shares;
    document.getElementById('guideLastUpdated').textContent = guide.lastUpdated;
    
    new bootstrap.Modal(document.getElementById('guideModal')).show();
}

function duplicateGuide(guideId) {
    console.log('Duplicating guide:', guideId);
    editGuide(guideId);
    document.getElementById('guideModalTitle').textContent = 'Sao chép hướng dẫn';
    document.getElementById('guideTitle').value += ' (Copy)';
    currentGuideId = null;
    isEditMode = false;
    document.getElementById('guideAnalyticsCard').style.display = 'none';
}

function viewGuideStats(guideId) {
    console.log('Viewing guide stats:', guideId);
    showToast('Hiển thị thống kê chi tiết hướng dẫn', 'info');
}

function approveGuide(guideId) {
    if (confirm('Bạn có chắc chắn muốn duyệt hướng dẫn này?')) {
        console.log('Approving guide:', guideId);
        showToast('Đã duyệt hướng dẫn thành công!', 'success');
    }
}

function rejectGuide(guideId) {
    const reason = prompt('Lý do từ chối:');
    if (reason) {
        console.log('Rejecting guide:', guideId, 'Reason:', reason);
        showToast('Đã từ chối hướng dẫn!', 'warning');
    }
}

function saveGuideAsDraft() {
    const title = document.getElementById('guideTitle').value;
    const description = document.getElementById('guideDescription').value;
    const content = document.getElementById('guideContentEditor').innerHTML;
    const category = document.getElementById('guideCategory').value;
    
    if (!title || !description || !content || !category) {
        showToast('Vui lòng điền đầy đủ thông tin bắt buộc', 'error');
        return;
    }
    
    console.log('Saving guide as draft');
    showToast('Đã lưu bản nháp thành công!', 'success');
    bootstrap.Modal.getInstance(document.getElementById('guideModal')).hide();
}

function submitForReview() {
    const title = document.getElementById('guideTitle').value;
    const description = document.getElementById('guideDescription').value;
    const content = document.getElementById('guideContentEditor').innerHTML;
    const category = document.getElementById('guideCategory').value;
    
    if (!title || !description || !content || !category) {
        showToast('Vui lòng điền đầy đủ thông tin bắt buộc', 'error');
        return;
    }
    
    console.log('Submitting guide for review');
    showToast('Đã gửi hướng dẫn để duyệt!', 'info');
    bootstrap.Modal.getInstance(document.getElementById('guideModal')).hide();
}

function publishGuideNow() {
    const title = document.getElementById('guideTitle').value;
    const description = document.getElementById('guideDescription').value;
    const content = document.getElementById('guideContentEditor').innerHTML;
    const category = document.getElementById('guideCategory').value;
    
    if (!title || !description || !content || !category) {
        showToast('Vui lòng điền đầy đủ thông tin bắt buộc', 'error');
        return;
    }
    
    console.log('Publishing guide now');
    showToast('Đã xuất bản hướng dẫn thành công!', 'success');
    bootstrap.Modal.getInstance(document.getElementById('guideModal')).hide();
}

// Rich text editor functions
function formatText(command) {
    document.execCommand(command, false, null);
    document.getElementById('guideContentEditor').focus();
}

function insertList(type) {
    document.execCommand(type === 'ul' ? 'insertUnorderedList' : 'insertOrderedList', false, null);
    document.getElementById('guideContentEditor').focus();
}

function insertLink() {
    const url = prompt('Nhập URL:');
    if (url) {
        document.execCommand('createLink', false, url);
    }
    document.getElementById('guideContentEditor').focus();
}

function insertImage() {
    const url = prompt('Nhập URL hình ảnh:');
    if (url) {
        document.execCommand('insertImage', false, url);
    }
    document.getElementById('guideContentEditor').focus();
}

function insertCode() {
    const selection = window.getSelection();
    if (selection.rangeCount > 0) {
        const range = selection.getRangeAt(0);
        const code = document.createElement('code');
        code.appendChild(range.extractContents());
        range.insertNode(code);
        selection.removeAllRanges();
    }
    document.getElementById('guideContentEditor').focus();
}

function bulkPublish() {
    const selected = Array.from(document.querySelectorAll('input[name="guideSelect"]:checked')).map(cb => cb.value);
    
    if (selected.length === 0) {
        showToast('Vui lòng chọn ít nhất một hướng dẫn', 'error');
        return;
    }
    
    if (confirm(`Xuất bản ${selected.length} hướng dẫn đã chọn?`)) {
        console.log('Bulk publishing:', selected);
        showToast(`Đã xuất bản ${selected.length} hướng dẫn thành công!`, 'success');
    }
}

function bulkReview() {
    const selected = Array.from(document.querySelectorAll('input[name="guideSelect"]:checked')).map(cb => cb.value);
    
    if (selected.length === 0) {
        showToast('Vui lòng chọn ít nhất một hướng dẫn', 'error');
        return;
    }
    
    if (confirm(`Gửi ${selected.length} hướng dẫn để duyệt?`)) {
        console.log('Bulk review:', selected);
        showToast(`Đã gửi ${selected.length} hướng dẫn để duyệt!`, 'info');
    }
}

function bulkArchive() {
    const selected = Array.from(document.querySelectorAll('input[name="guideSelect"]:checked')).map(cb => cb.value);
    
    if (selected.length === 0) {
        showToast('Vui lòng chọn ít nhất một hướng dẫn', 'error');
        return;
    }
    
    if (confirm(`Ẩn ${selected.length} hướng dẫn đã chọn?`)) {
        console.log('Bulk archiving:', selected);
        showToast(`Đã ẩn ${selected.length} hướng dẫn thành công!`, 'success');
    }
}

function manageGuideCategories() {
    showToast('Quản lý danh mục hướng dẫn', 'info');
}

function viewGuideAnalytics() {
    showToast('Hiển thị phân tích hướng dẫn', 'info');
}

function importGuides() {
    showToast('Chức năng nhập hướng dẫn từ file', 'info');
}

function exportGuides() {
    showToast('Đang xuất danh sách hướng dẫn...', 'info');
    setTimeout(() => {
        showToast('Đã xuất file thành công!', 'success');
    }, 2000);
}

function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = `alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show position-fixed`;
    toast.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    toast.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.remove();
    }, 5000);
}

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    // Initialize tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
    
    // Select all checkbox functionality
    document.getElementById('selectAll').addEventListener('change', function() {
        const checkboxes = document.querySelectorAll('input[name="guideSelect"]');
        checkboxes.forEach(cb => cb.checked = this.checked);
    });
    
    // Content editor save functionality
    const editor = document.getElementById('guideContentEditor');
    if (editor) {
        editor.addEventListener('input', function() {
            document.getElementById('guideContent').value = this.innerHTML;
        });
    }
});
</script>
